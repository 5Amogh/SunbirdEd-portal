!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@angular/core"),require("rxjs"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("sunbird-web-extension",["exports","tslib","@angular/core","rxjs","@angular/platform-browser"],t):t(n["sunbird-web-extension"]={},n.tslib,n.ng.core,null,n.ng.platformBrowser)}(this,function(n,a,s,t,e){"use strict";var i=function(n){this.name=n.name,this.priority=n.priority,this.component=n.component},c=function(n,t){this.plugin=n,this.placement=t},r=function(){function n(){this.plugins=[],this.change=new t.ReplaySubject(1)}return n.prototype.loadPlugins=function(n){if(!n||!Array.isArray(n.plugins))throw new Error("invalid framework configuration! Failed to load plugins!");var t,e,i=n.plugins.map(function(n){return n.main});try{for(var r=a.__values(i),o=r.next();!o.done;o=r.next()){var u=o.value;this.loadPlugin(u)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=r["return"])&&e.call(r)}finally{if(t)throw t.error}}},n.prototype.loadPlugin=function(n){var t=n,e={type:t,config:t._pluginConfig,instance:new t};this.plugins=this.plugins.concat([e]),this.change.next(this.plugins)},n.prototype.removePlugin=function(t){var n=this.plugins.find(function(n){return n.name===t});if(n){var e=this.plugins.slice();e.splice(e.indexOf(n),1),this.plugins=e,this.change.next(this.plugins)}},n.prototype.getPluginData=function(e){return this.plugins.reduce(function(n,t){return n.concat(t.config.placements.filter(function(n){return n.name===e}).map(function(n){return new c(t,n)}))},[])},n.decorators=[{type:s.Injectable}],n.ctorParameters=function(){return[]},n}(),o=function(){function n(n,t,e){var i=this;this.override=!1,this.output=new s.EventEmitter,this.componentRefs=[],this.viewContainerRef=n,this.componentResolver=t,this.pluginService=e,this.pluginChangeSubscription=this.pluginService.change.subscribe(function(n){return i.initialize()})}return n.prototype.ngOnInit=function(){this.initialize()},n.prototype.initialize=function(){var t=this;if(this.name){var n=this.pluginService.getPluginData(this.name);return this.override?(n.sort(function(n,t){return n.placement.priority>t.placement.priority?1:n.placement.priority<t.placement.priority?-1:0}),this.instantiatePluginComponent(n.shift())):(n.sort(function(n,t){return n.placement.priority>t.placement.priority?1:n.placement.priority<t.placement.priority?-1:0}),Promise.all(n.map(function(n){return t.instantiatePluginComponent(n)})))}},n.prototype.instantiatePluginComponent=function(n){var t=this;if(n){var e=this.componentResolver.resolveComponentFactory(n.placement.component),i=this.viewContainerRef.parentInjector,r=[{provide:c,useValue:n}],o=s.ReflectiveInjector.resolveAndCreate(r,i),u=this.viewContainerRef.createComponent(e,this.viewContainerRef.length,o);return u.instance.input=this.input,u.instance.output=u.instance.output||new s.EventEmitter,u.instance.output.subscribe(function(n){return t.output.emit(n)}),this.componentRefs.push(u),u.changeDetectorRef.markForCheck(),u.changeDetectorRef.detectChanges(),u}},n.prototype.ngOnChanges=function(){var t=this;this.componentRefs.length&&this.componentRefs.forEach(function(n){return n.instance.input=t.input,n.instance.ngOnChanges?n.instance.ngOnChanges():undefined})},n.prototype.ngOnDestroy=function(){this.componentRefs.length&&(this.componentRefs.forEach(function(n){return n.destroy()}),this.componentRefs=[]),this.pluginChangeSubscription.unsubscribe()},n.decorators=[{type:s.Directive,args:[{selector:"extension-point"}]}],n.ctorParameters=function(){return[{type:undefined,decorators:[{type:s.Inject,args:[s.ViewContainerRef]}]},{type:undefined,decorators:[{type:s.Inject,args:[s.ComponentFactoryResolver]}]},{type:undefined,decorators:[{type:s.Inject,args:[r]}]}]},n.propDecorators={name:[{type:s.Input}],override:[{type:s.Input}],input:[{type:s.Input}],output:[{type:s.Output}]},n}(),u=function(){function n(n){this.pluginService=n}return n.prototype.initialize=function(n){this.config=n,this.pluginService.loadPlugins(this.config)},n.decorators=[{type:s.Injectable}],n.ctorParameters=function(){return[{type:r}]},n}(),p=function(){function n(){}return n.forRoot=function(){return{ngModule:n,providers:[r]}},n.decorators=[{type:s.NgModule,args:[{declarations:[o],imports:[e.BrowserModule],exports:[o],providers:[r,u],entryComponents:[]}]}],n}();n.WebExtensionModule=p,n.BootstrapFramework=u,n.ExtensionPointDirective=o,n.PluginConfig=function(t){return function(n){n._pluginConfig=t}},n.PluginPlacement=i,n.PluginData=c,n.PluginService=r,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=sunbird-web-extension.umd.min.js.map