!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("tslib"),require("@angular/core"),require("rxjs"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("sunbird-web-extension",["exports","tslib","@angular/core","rxjs","@angular/platform-browser"],n):n(e["sunbird-web-extension"]={},e.tslib,e.ng.core,null,e.ng.platformBrowser)}(this,function(e,a,s,n,t){"use strict";var i=function(e){this.name=e.name,this.priority=e.priority,this.component=e.component},u=function(e,n){this.plugin=e,this.placement=n},r=function(){function e(){this.plugins=[],this.change=new n.ReplaySubject(1)}return e.prototype.loadPlugins=function(e){if(!e||!Array.isArray(e.plugins))throw new Error("invalid framework configuration! Failed to load plugins!");var n,t,i=e.plugins.map(function(e){return e.main});try{for(var r=a.__values(i),o=r.next();!o.done;o=r.next()){var s=o.value;this.loadPlugin(s)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(t=r["return"])&&t.call(r)}finally{if(n)throw n.error}}},e.prototype.loadPlugin=function(e){var n=e,t={type:n,config:n._pluginConfig,instance:new n};this.plugins=this.plugins.concat([t]),this.change.next(this.plugins)},e.prototype.removePlugin=function(n){var e=this.plugins.find(function(e){return e.name===n});if(e){var t=this.plugins.slice();t.splice(t.indexOf(e),1),this.plugins=t,this.change.next(this.plugins)}},e.prototype.getPluginData=function(t){return this.plugins.reduce(function(e,n){return e.concat(n.config.placements.filter(function(e){return e.name===t}).map(function(e){return new u(n,e)}))},[])},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[]},e}(),o=function(){function e(e,n,t){var i=this;this.override=!1,this.viewContainerRef=e,this.componentResolver=n,this.pluginService=t,this.componentRefs=[],this.pluginChangeSubscription=this.pluginService.change.subscribe(function(){return i.initialize()})}return e.prototype.initialize=function(){var n=this;if(this.name){0<this.componentRefs.length&&(this.componentRefs.forEach(function(e){return e.destroy()}),this.componentRefs=[]);var e=this.pluginService.getPluginData(this.name);return this.override?(e.sort(function(e,n){return e.placement.priority>n.placement.priority?1:e.placement.priority<n.placement.priority?-1:0}),this.instantiatePluginComponent(e.shift())):(e.sort(function(e,n){return e.placement.priority>n.placement.priority?1:e.placement.priority<n.placement.priority?-1:0}),Promise.all(e.map(function(e){return n.instantiatePluginComponent(e)})))}},e.prototype.instantiatePluginComponent=function(e){if(e){var n=this.componentResolver.resolveComponentFactory(e.placement.component),t=this.viewContainerRef.parentInjector,i=[{provide:u,useValue:e}],r=s.ReflectiveInjector.resolveAndCreate(i,t),o=this.viewContainerRef.createComponent(n,this.viewContainerRef.length,r);return this.componentRefs.push(o),o.changeDetectorRef.markForCheck(),o.changeDetectorRef.detectChanges(),o}},e.prototype.ngOnChanges=function(){this.initialize()},e.prototype.ngOnDestroy=function(){this.pluginChangeSubscription.unsubscribe()},e.decorators=[{type:s.Directive,args:[{selector:"extension-point"}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:s.Inject,args:[s.ViewContainerRef]}]},{type:undefined,decorators:[{type:s.Inject,args:[s.ComponentFactoryResolver]}]},{type:undefined,decorators:[{type:s.Inject,args:[r]}]}]},e.propDecorators={name:[{type:s.Input}],override:[{type:s.Input}]},e}(),c=function(){function e(e){this.pluginService=e}return e.prototype.initialize=function(e){this.config=e,this.pluginService.loadPlugins(this.config)},e.decorators=[{type:s.Injectable}],e.ctorParameters=function(){return[{type:r}]},e}(),p=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[r]}},e.decorators=[{type:s.NgModule,args:[{declarations:[o],imports:[t.BrowserModule],exports:[o],providers:[r,c],entryComponents:[]}]}],e}();e.WebFrameworkModule=p,e.BootstrapFramework=c,e.ExtenstionPointDirective=o,e.PluginConfig=function(n){return function(e){e._pluginConfig=n}},e.PluginPlacement=i,e.PluginData=u,e.PluginService=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sunbird-web-extension.umd.min.js.map