import { UciData } from '../../models/uci.model';
import { Component } from '@angular/core';
import * as CONSTANTS from '../../common/constants.json';
/* tslint:disable */
import * as _ from 'lodash';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "../../services/uci.service";
import * as i3 from "../../telemetry-utils.service";
import * as i4 from "../../services/config.service";
import * as i5 from "@angular/common";
/* tslint:enable */
export class SidePanelComponent {
    constructor(router, uciService, activatedRoute, telemetryUtils, configService) {
        this.router = router;
        this.uciService = uciService;
        this.activatedRoute = activatedRoute;
        this.telemetryUtils = telemetryUtils;
        this.configService = configService;
        this.defaultPage = 'categories';
        this.menu = [];
        this.showSideMenu = true;
    }
    ngOnInit() {
        // TODO: loader or spinner
        this.telemetryUtils.setContext([]);
        this.hideSidePanel = document.body.classList.contains('widget');
        this.telemetryUtils.logImpression(UciData.IPageName.HOME);
        this.data = this.configService.getConfig();
        const menuArr = _.get(this.data, 'menuOptions') && _.get(this.data, 'menuOptions').length > 0 ? this.data.menuOptions : CONSTANTS.MENUOPTIONS;
        for (let i = 0; i < menuArr.length; i++) {
            if (menuArr[i].enable) {
                this.menu.push(menuArr[i]);
            }
        }
    }
    isActive(selectedItem) {
        if (this.router.url.indexOf(`/${selectedItem}`) > -1 || this.selectedTab === selectedItem) {
            if (!this.selectedTab) {
                this.selectedTab = selectedItem;
            }
            return true;
        }
        else if (selectedItem === 'categories' && !this.selectedTab) {
            return true;
        }
        return false;
    }
    navigate(pageName, event) {
        this.selectedTab = pageName;
        this.telemetryUtils.setContext([]);
        if (event) {
            this.telemetryUtils.logInteract(event, UciData.IPageName.HOME);
        }
        this.router.navigate([`uci-admin`], { queryParamsHandling: 'merge' });
        this.closeNav();
    }
    ngOnDestroy() {
        if (this.paramsSubscription) {
            this.paramsSubscription.unsubscribe();
        }
    }
    showMenuButton() {
        this.showSideMenu = this.showSideMenu ? false : true;
    }
    closeNav() {
        this.showSideMenu = this.showSideMenu ? false : true;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: SidePanelComponent, deps: [{ token: i1.Router }, { token: i2.UciService }, { token: i1.ActivatedRoute }, { token: i3.TelemetryUtilsService }, { token: i4.ConfigService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: SidePanelComponent, selector: "lib-side-panel", ngImport: i0, template: "<ul class=\"sb-sidebar-menu pl-0\" *ngIf=\"!hideSidePanel\">\n    <li *ngFor='let d of menu' class=\"ua-sidebar-menu-list\" [ngClass]=\"{'menu-active': isActive(d.route)}\"\n        (click)=\"navigate(d.route, $event)\" id=\"d.route\"><a>{{d.label}}</a></li>\n</ul>\n\n<!-- for mobile-view -->\n<button type=\"button\" class=\"openbtn\" (click)=\"showMenuButton()\">\u2630</button>\n<div class=\"overlay-sidebar\" *ngIf=\"!showSideMenu\">\n    <div class=\"overlay-sidebar__menu\">\n        <a href=\"javascript:void(0)\" class=\"closebtn\" (click)=\"closeNav()\">&times;</a>\n        <div class=\"sidebar-menu__content\">\n            <ul class=\"sb-sidebar-menu-mob pl-0\">\n                <li class=\"ua-sidebar-menu-list\" *ngIf=\"false\" (click)=\"navigate('', $event)\" id=\"all-discussions\"><a>Bots</a>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n", styles: [".sb-sidebar-menu{list-style-type:none;margin-bottom:0;height:100%;display:inline}.sb-sidebar-menu li{margin-bottom:0;padding:.75rem 1rem;font-size:14px;color:#333;border-left:.125rem solid transparent;cursor:pointer}.sb-sidebar-menu-mob{list-style-type:none;margin-bottom:0;height:100%;display:inline}.sb-sidebar-menu li.menu-active{background-color:var(--white);font-weight:700;border-left:3px solid #005391;color:#002e50;border-bottom:0px}.openbtn,.overlay-sidebar{display:none}@media (max-width: 768px){.sb-sidebar-menu{display:none}.openbtn{display:inline;border:none;cursor:pointer;height:40px;width:40px;border-radius:16px;font-size:22px;background-color:#fff;box-shadow:3px 3px 2px #0000001a;color:#0245fd}.overlay-sidebar{height:100vh;width:100%;overflow:hidden;background:#0006;inset:0;position:absolute;display:inline;z-index:3;transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:background-color,visibility}.overlay-sidebar__menu{position:relative;top:0;height:100%;width:15rem;right:0;z-index:100000;overflow-y:auto;overflow-x:hidden;background-color:#f5f6fa;color:#000000de;box-shadow:0 8px 10px -5px #0003,0 16px 24px 2px #00000024,0 6px 30px 5px #000}.sidebar-menu__content{padding:0 1rem;height:100%}.closebtn{font-size:2.5rem;display:flex;justify-content:flex-end;padding-right:1rem;cursor:pointer}.ua-sidebar-menu-list{margin-bottom:.5rem;position:relative;padding:.675rem;font-size:.875rem}.sb-sidebar-menu-mob li{margin-bottom:0;padding:.75rem 1rem;font-size:14px;color:#333;border-left:.125rem solid transparent;cursor:pointer}.sb-sidebar-menu-mob li.menu-active{background-color:var(--white);font-weight:700;border-left:3px solid #005391;color:#002e50;border-bottom:0px}.sb-sidebar-menu-mob li:hover{background-color:var(--white);font-weight:700;color:#002e50}}\n"], dependencies: [{ kind: "directive", type: i5.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i5.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: SidePanelComponent, decorators: [{
            type: Component,
            args: [{ selector: 'lib-side-panel', template: "<ul class=\"sb-sidebar-menu pl-0\" *ngIf=\"!hideSidePanel\">\n    <li *ngFor='let d of menu' class=\"ua-sidebar-menu-list\" [ngClass]=\"{'menu-active': isActive(d.route)}\"\n        (click)=\"navigate(d.route, $event)\" id=\"d.route\"><a>{{d.label}}</a></li>\n</ul>\n\n<!-- for mobile-view -->\n<button type=\"button\" class=\"openbtn\" (click)=\"showMenuButton()\">\u2630</button>\n<div class=\"overlay-sidebar\" *ngIf=\"!showSideMenu\">\n    <div class=\"overlay-sidebar__menu\">\n        <a href=\"javascript:void(0)\" class=\"closebtn\" (click)=\"closeNav()\">&times;</a>\n        <div class=\"sidebar-menu__content\">\n            <ul class=\"sb-sidebar-menu-mob pl-0\">\n                <li class=\"ua-sidebar-menu-list\" *ngIf=\"false\" (click)=\"navigate('', $event)\" id=\"all-discussions\"><a>Bots</a>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n", styles: [".sb-sidebar-menu{list-style-type:none;margin-bottom:0;height:100%;display:inline}.sb-sidebar-menu li{margin-bottom:0;padding:.75rem 1rem;font-size:14px;color:#333;border-left:.125rem solid transparent;cursor:pointer}.sb-sidebar-menu-mob{list-style-type:none;margin-bottom:0;height:100%;display:inline}.sb-sidebar-menu li.menu-active{background-color:var(--white);font-weight:700;border-left:3px solid #005391;color:#002e50;border-bottom:0px}.openbtn,.overlay-sidebar{display:none}@media (max-width: 768px){.sb-sidebar-menu{display:none}.openbtn{display:inline;border:none;cursor:pointer;height:40px;width:40px;border-radius:16px;font-size:22px;background-color:#fff;box-shadow:3px 3px 2px #0000001a;color:#0245fd}.overlay-sidebar{height:100vh;width:100%;overflow:hidden;background:#0006;inset:0;position:absolute;display:inline;z-index:3;transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:background-color,visibility}.overlay-sidebar__menu{position:relative;top:0;height:100%;width:15rem;right:0;z-index:100000;overflow-y:auto;overflow-x:hidden;background-color:#f5f6fa;color:#000000de;box-shadow:0 8px 10px -5px #0003,0 16px 24px 2px #00000024,0 6px 30px 5px #000}.sidebar-menu__content{padding:0 1rem;height:100%}.closebtn{font-size:2.5rem;display:flex;justify-content:flex-end;padding-right:1rem;cursor:pointer}.ua-sidebar-menu-list{margin-bottom:.5rem;position:relative;padding:.675rem;font-size:.875rem}.sb-sidebar-menu-mob li{margin-bottom:0;padding:.75rem 1rem;font-size:14px;color:#333;border-left:.125rem solid transparent;cursor:pointer}.sb-sidebar-menu-mob li.menu-active{background-color:var(--white);font-weight:700;border-left:3px solid #005391;color:#002e50;border-bottom:0px}.sb-sidebar-menu-mob li:hover{background-color:var(--white);font-weight:700;color:#002e50}}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.Router }, { type: i2.UciService }, { type: i1.ActivatedRoute }, { type: i3.TelemetryUtilsService }, { type: i4.ConfigService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lkZS1wYW5lbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy91Y2ktY29uc29sZS9zcmMvbGliL2NvbXBvbmVudHMvc2lkZS1wYW5lbC9zaWRlLXBhbmVsLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3VjaS1jb25zb2xlL3NyYy9saWIvY29tcG9uZW50cy9zaWRlLXBhbmVsL3NpZGUtcGFuZWwuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLHdCQUF3QixDQUFDO0FBRy9DLE9BQU8sRUFBQyxTQUFTLEVBQW9CLE1BQU0sZUFBZSxDQUFDO0FBRzNELE9BQU8sS0FBSyxTQUFTLE1BQU0sNkJBQTZCLENBQUM7QUFDekQsb0JBQW9CO0FBQ3BCLE9BQU8sS0FBSyxDQUFDLE1BQU0sUUFBUSxDQUFDOzs7Ozs7O0FBSTVCLG1CQUFtQjtBQU9uQixNQUFNLE9BQU8sa0JBQWtCO0lBYzNCLFlBQ1csTUFBYyxFQUNkLFVBQXNCLEVBQ3RCLGNBQThCLEVBQzdCLGNBQXFDLEVBQ3JDLGFBQTRCO1FBSjdCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQ3RCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM3QixtQkFBYyxHQUFkLGNBQWMsQ0FBdUI7UUFDckMsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFieEMsZ0JBQVcsR0FBRyxZQUFZLENBQUM7UUFJM0IsU0FBSSxHQUF3QixFQUFFLENBQUM7UUFFL0IsaUJBQVksR0FBWSxJQUFJLENBQUM7SUFTN0IsQ0FBQztJQUVELFFBQVE7UUFDSiwwQkFBMEI7UUFDMUIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDbkMsSUFBSSxDQUFDLGFBQWEsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDaEUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxRCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDM0MsTUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxhQUFhLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQztRQUM5SSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNyQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUU7Z0JBQ25CLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQzlCO1NBQ0o7SUFFTCxDQUFDO0lBRUQsUUFBUSxDQUFDLFlBQVk7UUFDakIsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxZQUFZLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxXQUFXLEtBQUssWUFBWSxFQUFFO1lBQ3ZGLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO2dCQUNuQixJQUFJLENBQUMsV0FBVyxHQUFHLFlBQVksQ0FBQzthQUNuQztZQUNELE9BQU8sSUFBSSxDQUFDO1NBQ2Y7YUFBTSxJQUFJLFlBQVksS0FBSyxZQUFZLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQzNELE9BQU8sSUFBSSxDQUFDO1NBQ2Y7UUFDRCxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsUUFBUSxDQUFDLFFBQWdCLEVBQUUsS0FBTTtRQUM3QixJQUFJLENBQUMsV0FBVyxHQUFHLFFBQVEsQ0FBQztRQUM1QixJQUFJLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNuQyxJQUFJLEtBQUssRUFBRTtZQUNQLElBQUksQ0FBQyxjQUFjLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2xFO1FBQ0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFDLG1CQUFtQixFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7UUFDcEUsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxXQUFXO1FBQ1AsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7WUFDekIsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3pDO0lBQ0wsQ0FBQztJQUVELGNBQWM7UUFDVixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ3pELENBQUM7SUFFRCxRQUFRO1FBQ0osSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUN6RCxDQUFDOytHQXhFUSxrQkFBa0I7bUdBQWxCLGtCQUFrQixzRENuQi9CLDYzQkFrQkE7OzRGRENhLGtCQUFrQjtrQkFMOUIsU0FBUzsrQkFDSSxnQkFBZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VjaURhdGF9IGZyb20gJy4uLy4uL21vZGVscy91Y2kubW9kZWwnO1xuaW1wb3J0IHtUZWxlbWV0cnlVdGlsc1NlcnZpY2V9IGZyb20gJy4uLy4uL3RlbGVtZXRyeS11dGlscy5zZXJ2aWNlJztcbmltcG9ydCB7VWNpU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvdWNpLnNlcnZpY2UnO1xuaW1wb3J0IHtDb21wb25lbnQsIE9uRGVzdHJveSwgT25Jbml0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7QWN0aXZhdGVkUm91dGUsIFJvdXRlcn0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7U3Vic2NyaXB0aW9ufSBmcm9tICdyeGpzJztcbmltcG9ydCAqIGFzIENPTlNUQU5UUyBmcm9tICcuLi8uLi9jb21tb24vY29uc3RhbnRzLmpzb24nO1xuLyogdHNsaW50OmRpc2FibGUgKi9cbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7Q29uZmlnU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHtJZGlzY3Vzc2lvbkNvbmZpZywgSU1lbnVPcHRpb25zfSBmcm9tICcuLi8uLi9tb2RlbHMvdWNpLWNvbmZpZy5tb2RlbCc7XG5cbi8qIHRzbGludDplbmFibGUgKi9cblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdsaWItc2lkZS1wYW5lbCcsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3NpZGUtcGFuZWwuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL3NpZGUtcGFuZWwuY29tcG9uZW50LnNjc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBTaWRlUGFuZWxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cbiAgICBwYXJhbXNTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcblxuICAgIHVzZXJOYW1lOiBzdHJpbmc7XG5cbiAgICBkZWZhdWx0UGFnZSA9ICdjYXRlZ29yaWVzJztcblxuICAgIGRhdGE6IElkaXNjdXNzaW9uQ29uZmlnO1xuICAgIGhpZGVTaWRlUGFuZWw6IGJvb2xlYW47XG4gICAgbWVudTogQXJyYXk8SU1lbnVPcHRpb25zPiA9IFtdO1xuICAgIHNlbGVjdGVkVGFiOiBzdHJpbmc7XG4gICAgc2hvd1NpZGVNZW51OiBCb29sZWFuID0gdHJ1ZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgcm91dGVyOiBSb3V0ZXIsXG4gICAgICAgIHB1YmxpYyB1Y2lTZXJ2aWNlOiBVY2lTZXJ2aWNlLFxuICAgICAgICBwdWJsaWMgYWN0aXZhdGVkUm91dGU6IEFjdGl2YXRlZFJvdXRlLFxuICAgICAgICBwcml2YXRlIHRlbGVtZXRyeVV0aWxzOiBUZWxlbWV0cnlVdGlsc1NlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgY29uZmlnU2VydmljZTogQ29uZmlnU2VydmljZVxuICAgICkge1xuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICAvLyBUT0RPOiBsb2FkZXIgb3Igc3Bpbm5lclxuICAgICAgICB0aGlzLnRlbGVtZXRyeVV0aWxzLnNldENvbnRleHQoW10pO1xuICAgICAgICB0aGlzLmhpZGVTaWRlUGFuZWwgPSBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygnd2lkZ2V0Jyk7XG4gICAgICAgIHRoaXMudGVsZW1ldHJ5VXRpbHMubG9nSW1wcmVzc2lvbihVY2lEYXRhLklQYWdlTmFtZS5IT01FKTtcbiAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5jb25maWdTZXJ2aWNlLmdldENvbmZpZygpO1xuICAgICAgICBjb25zdCBtZW51QXJyID0gXy5nZXQodGhpcy5kYXRhLCAnbWVudU9wdGlvbnMnKSAmJiBfLmdldCh0aGlzLmRhdGEsICdtZW51T3B0aW9ucycpLmxlbmd0aCA+IDAgPyB0aGlzLmRhdGEubWVudU9wdGlvbnMgOiBDT05TVEFOVFMuTUVOVU9QVElPTlM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWVudUFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG1lbnVBcnJbaV0uZW5hYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW51LnB1c2gobWVudUFycltpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGlzQWN0aXZlKHNlbGVjdGVkSXRlbSkge1xuICAgICAgICBpZiAodGhpcy5yb3V0ZXIudXJsLmluZGV4T2YoYC8ke3NlbGVjdGVkSXRlbX1gKSA+IC0xIHx8IHRoaXMuc2VsZWN0ZWRUYWIgPT09IHNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkVGFiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFRhYiA9IHNlbGVjdGVkSXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkSXRlbSA9PT0gJ2NhdGVnb3JpZXMnICYmICF0aGlzLnNlbGVjdGVkVGFiKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbmF2aWdhdGUocGFnZU5hbWU6IHN0cmluZywgZXZlbnQ/KSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRUYWIgPSBwYWdlTmFtZTtcbiAgICAgICAgdGhpcy50ZWxlbWV0cnlVdGlscy5zZXRDb250ZXh0KFtdKTtcbiAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLnRlbGVtZXRyeVV0aWxzLmxvZ0ludGVyYWN0KGV2ZW50LCBVY2lEYXRhLklQYWdlTmFtZS5IT01FKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbYHVjaS1hZG1pbmBdLCB7cXVlcnlQYXJhbXNIYW5kbGluZzogJ21lcmdlJ30pO1xuICAgICAgICB0aGlzLmNsb3NlTmF2KCk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmFtc1N1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy5wYXJhbXNTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNob3dNZW51QnV0dG9uKCkge1xuICAgICAgICB0aGlzLnNob3dTaWRlTWVudSA9IHRoaXMuc2hvd1NpZGVNZW51ID8gZmFsc2UgOiB0cnVlO1xuICAgIH1cblxuICAgIGNsb3NlTmF2KCkge1xuICAgICAgICB0aGlzLnNob3dTaWRlTWVudSA9IHRoaXMuc2hvd1NpZGVNZW51ID8gZmFsc2UgOiB0cnVlO1xuICAgIH1cblxufVxuIiwiPHVsIGNsYXNzPVwic2Itc2lkZWJhci1tZW51IHBsLTBcIiAqbmdJZj1cIiFoaWRlU2lkZVBhbmVsXCI+XG4gICAgPGxpICpuZ0Zvcj0nbGV0IGQgb2YgbWVudScgY2xhc3M9XCJ1YS1zaWRlYmFyLW1lbnUtbGlzdFwiIFtuZ0NsYXNzXT1cInsnbWVudS1hY3RpdmUnOiBpc0FjdGl2ZShkLnJvdXRlKX1cIlxuICAgICAgICAoY2xpY2spPVwibmF2aWdhdGUoZC5yb3V0ZSwgJGV2ZW50KVwiIGlkPVwiZC5yb3V0ZVwiPjxhPnt7ZC5sYWJlbH19PC9hPjwvbGk+XG48L3VsPlxuXG48IS0tIGZvciBtb2JpbGUtdmlldyAtLT5cbjxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwib3BlbmJ0blwiIChjbGljayk9XCJzaG93TWVudUJ1dHRvbigpXCI+4piwPC9idXR0b24+XG48ZGl2IGNsYXNzPVwib3ZlcmxheS1zaWRlYmFyXCIgKm5nSWY9XCIhc2hvd1NpZGVNZW51XCI+XG4gICAgPGRpdiBjbGFzcz1cIm92ZXJsYXktc2lkZWJhcl9fbWVudVwiPlxuICAgICAgICA8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgY2xhc3M9XCJjbG9zZWJ0blwiIChjbGljayk9XCJjbG9zZU5hdigpXCI+JnRpbWVzOzwvYT5cbiAgICAgICAgPGRpdiBjbGFzcz1cInNpZGViYXItbWVudV9fY29udGVudFwiPlxuICAgICAgICAgICAgPHVsIGNsYXNzPVwic2Itc2lkZWJhci1tZW51LW1vYiBwbC0wXCI+XG4gICAgICAgICAgICAgICAgPGxpIGNsYXNzPVwidWEtc2lkZWJhci1tZW51LWxpc3RcIiAqbmdJZj1cImZhbHNlXCIgKGNsaWNrKT1cIm5hdmlnYXRlKCcnLCAkZXZlbnQpXCIgaWQ9XCJhbGwtZGlzY3Vzc2lvbnNcIj48YT5Cb3RzPC9hPlxuICAgICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICA8L3VsPlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbjwvZGl2PlxuIl19