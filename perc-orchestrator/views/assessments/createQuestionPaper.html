<div id="conformMessage" class="alert  hide" ></div>
<div class="List_view ng-cloak" ng-cloak ng-show="workflowStep == 1">
    <div class=" askquestionHeader">
        <div class="headerAsk">
            <h2>Create Question Paper</h2>
            <span class="backBtnCont">	            
	            <a href="javascript:void(0);" ng-click="backToList();" class="marginTop10 commonBackToList"><i class="fa fa-chevron-left"></i> Back to list</a>
        	</span>
        </div>

        <div class="textEditor AskQEdit marginTop10">
			<div class="row">
				<div class="form-group col-md-12" ng-class="{ 'has-error' : questionPaper.title == '' && questionPaper.isSubmitted }">
		            <div class="col-md-12 alert alert-danger hide qpInvalid" role="alert">Please fill all required fields.</div>
		            <div class="col-md-12 alert alert-success hide qpSaved" role="alert">Question Paper Saved.</div>
		            <input type="text" ng-model="questionPaper.title" class="form-control" placeholder="Question Paper Title">
		        </div>
			</div>
			<div class="row">
				<div class="form-group col-md-8" ng-class="{ 'has-error' : questionPaper.learningElement.name == '' && questionSetSearchSubmitted }">
		             <select ng-hide="questionPaper.identifier" ng-il-multiselect='{"placeholder":"Select Lecture...", "selectedDisable": true}' multiple="true" ng-model="questionPaper.learningElements" ng-options="lob.label for lob in quesionSetSearch.learningElements" style="width: 100%;"></select>
		        </div>
		        <div class="form-group col-md-4">
			        <select id="questionSetTypeList" ng-model="questionPaper.testType" class="form-control" ng-options="item for item in quesionSetSearch.testTypes" ng-hide="questionPaper.identifier">
			        </select>
			    </div>
			</div>
			<div class="row">
				<div class="form-group col-md-2 pull-right" ng-hide="questionPaper.identifier">
			        <button id="searchQuestionSets" class="btn btn-primary marginLeft5 form-control" ng-click="searchQuestionSets()">Search</button>
			    </div>
			</div>
    	</div>
    	
	    <div class="textEditor AskQEdit marginBottom10" ng-show="questionPaper.questionSets.count > 0">
	    	<div class="col-md-8 noPad">
	    		<div class="detailsQuestion QAcontent moveTop5">
		        	<ul>
		        		<li ng-show="questionPaper.identifier && questionPaper.testType"><span>Type: {{questionPaper.testType}}&nbsp;</span></li>
		        		<li ng-show="questionPaper.identifier && questionPaper.testType" class="list-dash"><span>|</span></li>
		                <li ng-show="questionPaper.identifier && questionPaper.learningElement.name"><span>Covers: {{questionPaper.learningElement.name}}&nbsp;</span></li>
		                <li ng-show="questionPaper.identifier && questionPaper.learningElement.name" class="list-dash"><span>|</span></li>
		                <li><span>Sets: {{questionPaper.questionSets.count}}&nbsp;</span></li>
		                <li class="list-dash"><span>|</span></li>
		                <li><span>Questions: {{questionPaper.questionSets.numQuestions}}&nbsp;</span></li>
		            </ul>
		        </div>
	    	</div>
	    	<div class="col-md-4 noPad" ng-show="questionPaper.questionSets.count > 0">
	    		<button id="saveQPBtmContinue" class="btn btn-primary pull-right marginLeft10" ng-click="savePaper('saveQPBtmContinue', true)">Save & Continue</button>
	    		<button id="saveQPBtm" class="btn btn-primary  pull-right" ng-click="savePaper('saveQPBtm', false)">Save</button>
	    	</div>
	    </div>

    	<div class="textEditor AskQEdit" ng-show="questionSets.show">
            <div class="QACol">
                <div class="alert alert-info fade in" role="alert" ng-show="questionSets.count == 0">
                    <p>There are no question sets with given search criteria.</p>
                </div>
                <div class="row" ng-repeat="questionSet in questionSets.data" style="border-bottom: 1px solid #ededed;">
                	<div class="col-md-10 QAcontent">
				        <h5>
				        	<a href="javascript:void(0);" class="ac-links il-Link-clr" ng-click="editQuestionSet(questionSet.identifier)" >{{questionSet.label}}</a>
						    <a href="javascript:void(0);" class="previewIcon marginLeft5" ng-click="addQuestionSet(questionSet)" ng-show="questionPaper.questionSets.ids.indexOf(questionSet.identifier) == -1">
					        	<i class="glyph16 fa fa-plus-circle marginTop5" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Add question set"></i>
						    </a>
				        </h5>
				        <div class="detailsQuestion moveTop5">
				            <ul class="metadata">
				                <li><span ng-repeat="level in questionSet.difficultyLevels">{{level}}&nbsp;</span></li>
				                <li class="list-dash"><span>|</span></li>
				                <li><span ng-repeat="purpose in questionSet.purposes">{{purpose}}</span></li>
				                <li class="list-dash"><span>|</span></li>
				                <li><span>covers: {{getContentTitleOfItem(questionSet.learningElement);}}</span></li>
				                <li class="list-dash"><span>|</span></li>
				                <li><span>Used in Paper: {{getQuestionPaperTitle(questionSet.qpList);}}</span></li>
				            </ul>
				        </div>
				        <p class="ac-contents" ng-bind-html="questionSet.description"></p>
				    </div>
				    <div class="col-md-2 QAStatus">
						<ul class="pull-right">
						    <li class="secondary">
						        <span class="number">{{questionSet.numQuestions}}</span>
						        <span>Questions</span>
						    </li>
						</ul>
					</div>
                </div>
            </div>
        </div>

        <div class="textEditor AskQEdit marginTop10" ng-show="questionPaper.questionSets.count > 0">
			<div class="save_btn">
				<button id="saveQPBtm" class="btn btn-primary" ng-click="savePaper('saveQPBtm', false)">Save</button>
    			<button id="saveQPBtmContinue" class="btn btn-primary" ng-click="savePaper('saveQPBtmContinue', true)">Save & Continue</button>
			</div>
			 <div class="clearfix"></div>
	    </div>
    </div>
</div>

<div class="List_view ng-cloak" ng-cloak ng-show="workflowStep == 2">
    <div class=" askquestionHeader">
    	<div class="headerAsk">
		    <div class="row">
		        <div class="col-md-10">
		            <h2 style="margin-top: 0px">{{questionPaper.title}}
		            	<a href="javascript:void(0);" class="tool-tip" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Add more Question Sets"><i ng-click="gotoStep1()" class="writeBlackOne  fa fa-plus" id="writeIcon"></i></a>
		            </h2>
		        </div>
		        <div class="col-md-2 marginTop20">
		        	<span class="pull-right">	            
			            <a href="javascript:void(0);" ng-click="backToList();" class="marginTop5 commonBackToList"><i class="fa fa-chevron-left"></i> Back to list</a>
		        	</span>
		        </div>
		    </div>
		</div>
		<div class="detailsQuestion QAcontent moveTop5">
        	<ul>
        		<li><span>Type: {{questionPaper.testType}}&nbsp;</span></li>
        		<li class="list-dash"><span>|</span></li>
                <li ng-show="questionPaper.learningElement.name"><span>Covers: {{questionPaper.learningElement.name}}&nbsp;</span></li>
                <li ng-show="questionPaper.learningElement.name" class="list-dash"><span>|</span></li>
                <li><span>Sets: {{questionPaper.questionSets.count}}&nbsp;</span></li>
                <li class="list-dash"><span>|</span></li>
                <li><span>Questions: {{questionPaper.questionSets.numQuestions}}&nbsp;</span></li>
            </ul>
        </div>
		<div class="textEditor AskQEdit">
			<div class="row">
	            <div class="col-md-12 alert alert-danger hide qpInvalid" role="alert">Please fill all required fields.</div>
	            <div class="col-md-12 alert alert-success hide qpSaved" role="alert">Question Paper Saved.</div>
	            <div class="col-md-6 form-group" ng-class="{ 'has-error' : questionPaper.totalQuestions <= 0 && questionPaper.isSubmitted }">
					<div>Total Questions*</div>
					<input type="text" class="form-control" ng-model="questionPaper.totalQuestions">
				</div>
				<div class="col-md-6 form-group" ng-class="{ 'has-error' : questionPaper.maxMarks <= 0 && questionPaper.isSubmitted }">
					<div>Maximum Marks*</div>
				<input type="text" class="form-control" ng-model="questionPaper.maxMarks">	
				</div>
			</div>
			<div class="row">
				<div class="col-md-4 form-group" ng-class="{ 'has-error' : questionPaper.duration <= 0 && questionPaper.isSubmitted }">
					<div>Duration (in mins)*</div>
					<input type="text" class="form-control" ng-model="questionPaper.duration">
				</div>
				<div class="col-md-4 form-group" ng-show="questionPaper.testType == 'Exam'" ng-class="{ 'has-error' : questionPaper.numConcretePapers <= 0 && questionPaper.isSubmitted }">
					<div>Concrete Papers*</div>
					<input type="text" class="form-control" ng-model="questionPaper.numConcretePapers">	
				</div>
				<div class="col-md-4 form-group" ng-class="{ 'has-error' : questionPaper.excludeQuestionsBefore.exclude && !questionPaper.excludeQuestionsBefore.duration && questionPaper.isSubmitted }">
            		<input type="checkbox" ng-model="questionPaper.excludeQuestionsBefore.exclude"> <span>Exclude used in last (in days)</span>
        			<input type="text" class="form-control" ng-disabled="!questionPaper.excludeQuestionsBefore.exclude" ng-model="questionPaper.excludeQuestionsBefore.duration"> 
        		</div>
			</div>
		</div>

	    <div class="textEditor AskQEdit" ng-show="questionSets.show">
            <div class="QACol">
            	<div class="row" style="border-bottom:1px solid #ededed;">
            		<div class="col-md-8"></div>
				  	<div class="col-md-2" style="text-align:center;"><div>No.of Questions</div></div>
				  	<div class="col-md-2" style="text-align:center;"><div>Marks Per Question</div></div>
            	</div>
            	<div class="row" ng-repeat="questionSet in questionPaper.questionSets.data" style="border-bottom: 1px solid #ededed;">
                    <div class="col-md-8 noPad" ng-include="'questionset_list_item_for_paper.html'"></div>
                    <div class="col-md-2 QAcontent form-group" ng-class="{ 'has-error' : !questionSet.numPickQuestions && questionPaper.isSubmitted }">
						<input style="" type="text" placeholder="Questions" class="form-control marginTop20" ng-model="questionSet.numPickQuestions">
					</div>
					<div class="col-md-2 QAcontent form-group" ng-class="{ 'has-error' : !questionSet.scorePerQuestion && questionPaper.isSubmitted }">
						<input style="" type="text" placeholder="Marks" class="form-control marginTop20" ng-model="questionSet.scorePerQuestion">
					</div>
                </div>
            </div>
        </div>

        <div class="textEditor AskQEdit marginTop10" ng-show="questionPaper.questionSets.count > 0">
			<div class="save_btn">
    			<button id="searchQP2Top" class="btn btn-primary" ng-click="savePaper('searchQP2Top', false)">Save</button>
    			<button id="searchQP2TopContinue" class="btn btn-primary" ng-click="savePaper('searchQP2TopContinue', true)">Save & Continue</button>
			</div>
			 <div class="clearfix"></div>
	    </div>

    </div>
</div>

<div class="List_view ng-cloak" ng-cloak ng-show="workflowStep == 3">
    <div class=" askquestionHeader">
    	<div class="headerAsk">
		    <div class="row">
		        <div class="col-md-10">
		            <h2>{{questionPaper.title}}</h2>
		        </div>
		        <div class="col-md-2 marginTop10">
		            <a href="javascript:void(0);" ng-click="backToList();" class="marginTop10 commonBackToList pull-right"><i class="fa fa-chevron-left"></i> Back to list</a>
		        </div>
		    </div>
		</div>
		<div class="detailsQuestion QAcontent moveTop5">
        	<ul>
        		<li><span>Type: {{questionPaper.testType}}&nbsp;</span></li>
        		<li class="list-dash"><span>|</span></li>
                <li ng-show="questionPaper.learningElement.name"><span>Covers: {{questionPaper.learningElement.name}}&nbsp;</span></li>
                <li ng-show="questionPaper.learningElement.name" class="list-dash"><span>|</span></li>
                <li><span>Questions: {{questionPaper.totalQuestions}}&nbsp;</span></li>
                <li class="list-dash"><span>|</span></li>
                <li><span>Marks: {{questionPaper.maxMarks}}&nbsp;</span></li>
                <li class="list-dash"><span>|</span></li>
                <li><span>Duration: {{questionPaper.duration*60 | readableTime}}&nbsp;</span></li>
                <li class="list-dash"><span>|</span></li>
                <li><span>Identifier: {{questionPaper.identifier}}</span></li>
            </ul>
        </div>

		<div class="textEditor AskQEdit">
			<div class="col-md-12 alert alert-danger hide qpInvalid" role="alert">Please fill all required fields.</div>
	        <div class="col-md-12 alert alert-success hide qpSaved" role="alert">Question Paper Saved.</div>
	        <div class="col-md-12 alert alert-danger hide qpPreviewInvalid" role="alert">Error while rendering Question Paper Preview.</div>
			<div>Validation</div>
			<div class="qp-preview-item col-md-12 padLeft25" style="padding-left: 25px;">
				<ul>
    				<li ng-class="{'icon-error-list' : validation.resultType == 'ERROR', 'icon-info-list' : validation.resultType == 'INFO'}" style="padding:5px;" class="col-md-12" ng-repeat="validation in questionPaper.validations">
    					<span class="qp-validation">{{validation.summary}}</span>
    				</li>
				</ul>
			</div>
		</div>
		<div class="textEditor AskQEdit">
			<div>Description</div>
    		<textarea rows="5" class="form-control" ng-model="questionPaper.description"></textarea>
		</div>
		<div class="textEditor AskQEdit">
			<div>Instructions</div>
    		<textarea rows="5" class="form-control" ng-model="questionPaper.instructions"></textarea>
		</div>
		<div class="textEditor AskQEdit">
			<div>Syllabus</div>
			<div class="qp-preview-item col-md-12">
				<div style="padding:0px 5px;" class="col-md-12" ng-repeat="item in questionPaper.syllabus">
				{{$index+1}}. {{item}}</div>
			</div>
		</div>
		<div class="textEditor AskQEdit" ng-show="questionPaper.testType == 'Exam'">
			<div>Concrete Question Papers</div>
			<div class="qp-preview-item">
    			
				<div class="row" ng-repeat="concretePaper in questionPaper.concretePapers">
					<div class="col-md-12">
						<h5><a href="javascript:void(0);" class="ac-links il-Link-clr" ng-click="previewPaper(concretePaper);">{{concretePaper.split(":")[1]}}</a></h5>
						<div class="detailsQuestion QAcontent">
							<ul>
								<li>Questions ({{questionPaper.totalQuestions}})</li>
								<li class="list-dash">|</li>
								<li>Total Marks {{questionPaper.maxMarks}}</li>
								<li class="list-dash">|</li>
								<li>{{questionPaper.duration*60 | readableTime}} duration</li>
							</ul>
						</div>
						<div class="clearfix" style="border-bottom: 1px solid #ededed; padding:10px;"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="textEditor AskQEdit" ng-show="questionPaper.learningActivities && questionPaper.learningActivities.length > 0">
			<div>Learning Activities</div>
			<div class="qp-preview-item">
				<div class="row" ng-repeat="learningActivity in questionPaper.learningActivities">
					<div class="col-md-12">
						<h5><a href="javascript:void(0);" class="ac-links il-Link-clr" ng-click="goToLearningActivity(learningActivity);">{{learningActivity.name}}</a></h5>
						<p class="ac-contents viewCtn" ng-bind-html="learningActivity.metadata.description"></p>
						<div class="clearfix" style="border-bottom: 1px solid #ededed; padding:10px;"></div>
					</div>
				</div>
			</div>
		</div>

		<div class="textEditor AskQEdit moveDown10" ng-show="questionPaper.testType == 'Exam'">
			<div class="save_btn">
    			<button id="savePaper3Exam" class="btn btn-primary marginLeft5" ng-click="savePaper('savePaper3Exam', false)">Save</button>
				<button class="btn btn-primary marginLeft5" ng-click="gotoStep2()">Change Criteria</button>
    			<button id="generateConcretePapers" class="btn btn-primary marginLeft5" ng-click="generateConcretePapers()">Generate Concrete Papers</button>
    			<button  class="btn btn-primary marginLeft5" ng-click="createExam(questionPaper.identifier)">Create Exam</button>
			</div>
			 <div class="clearfix"></div>
	    </div>

	    <div class="textEditor AskQEdit moveDown10" ng-show="questionPaper.testType == 'Practice'">
			<div class="save_btn">
				<button id="savePaper3Practice" class="btn btn-primary marginLeft5" ng-click="savePaper('savePaper3Practice', false)">Save</button>
				<button class="btn btn-primary marginLeft5" ng-click="gotoStep2()">Change Criteria</button>
	    		<button  class="btn btn-primary marginLeft5" ng-click="previewPaper()">Preview Sample Question Paper</button>
	    		<button class="btn btn-primary marginLeft25" ng-click="createExam(questionPaper.identifier)">Create Practice Exercise</button>
			</div>
			<div class="clearfix"></div>
		</div>

	</div>
</div>

<!-- Modal of the Question Paper Start -->
<div class="modal fade" id="questionPaperPreviewModal" tabindex="-1" role="dialog" aria-labelledby="question-popup-box" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <br/>
            </div>
            <div class="modal-body" style="display:flex;">
                <div class="col-md-12 noPad">
			    	<div ng-cloak class="col-md-12 noPad">
			    		<div class="row noMargin borderBottom">
			    			<div class="col-md-12">
				    			<h2 style="margin-top: 0px;">{{questionPaper.title}}</h2>
							</div>
			    		</div>
			    	</div>
			    	<div class="detailsQuestion QAcontent moveTop5">
			        	<ul>
			        		<li><span>Preview for: {{previewPaperName}}&nbsp;</span></li>
			        		<li class="list-dash"><span>|</span></li>
			        		<li><span>Type: {{questionPaper.testType}}&nbsp;</span></li>
			        		<li class="list-dash"><span>|</span></li>
			                <li ng-show="questionPaper.learningElement.name"><span>Covers: {{questionPaper.learningElement.name}}&nbsp;</span></li>
			                <li ng-show="questionPaper.learningElement.name" class="list-dash"><span>|</span></li>
			                <li><span>Questions: {{questionPaper.totalQuestions}}&nbsp;</span></li>
			                <li class="list-dash"><span>|</span></li>
			                <li><span>Marks: {{questionPaper.maxMarks}}&nbsp;</span></li>
			                <li class="list-dash"><span>|</span></li>
			                <li><span>Duration: {{questionPaper.duration*60 | readableTime}}</span></li>
			            </ul>
			        </div>
			    	<div class="col-md-12 noPad form-group">
						<div>Description</div>
						<div class="qp-preview-item" ng-bind-html="questionPaper.description"></div>
					</div>
					<div class="col-md-12 noPad form-group">
						<div>Instructions</div>
						<div class="qp-preview-item" ng-bind-html="questionPaper.instructions"></div>
					</div>
					<div class="col-md-12 noPad form-group">
						<div>Questions Preview</div>
						<div class="qp-preview-item">
							<!-- Preview render html start here -->
							<link href="/quiz/style/quizPlayer.css" rel="stylesheet">
							<div id="assessment-feedback-container" class="row-fluid span12 assessment-feedback-container " style="display:inline;">
					            <div id="responses" class="responses"></div>
					        </div>
					        <!-- Preview render html end here -->
						</div>
					</div>
					<div class="pull-right padTop">
			    		<button id="regenerateConcreteQP" ng-hide="questionPaper.testType == 'Practice'" class="btn btn-primary marginLeft5" disabled="disabled" ng-click="">Regenerate Concrete Paper</button>
			    	</div>
			    </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal of the Question Paper End -->


<script type="text/javascript">
var questionPaperContextSearchPrevValue = '';
$(document).ready(function() {
    $('.questionpaper-context-select').on('click focusin',function(evt) {
        evt.stopPropagation();
        $(".questionpaper-context-container").toggleClass("questionpaper-context-container-hover");
        $('.questionpaper-context-select').val('');
    });
    $(document).click(function() {
        $('.questionpaper-context-container').removeClass('questionpaper-context-container-hover');
        if ($('.questionpaper-context-select').val() == '') {
            $('.questionpaper-context-select').val(questionPaperContextSearchPrevValue);
        }
    });
});
</script>