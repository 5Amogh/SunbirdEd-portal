<!DOCTYPE html>
<html lang="en" ng-app="importApp">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta id="extViewportMeta" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <link rel="shortcut icon" href="images/favicon.png">
    <title>SunBird</title>
    <script type="text/javascript" src="https://fast.fonts.net/jsapi/6bb78b32-9b12-4a14-9179-8de98470e4b1.js"></script>
    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/common.css" type="text/css">
    <link rel="stylesheet" href="/css/custom_prev.css" type="text/css">
    <link rel="stylesheet" href="/css/app.css" type="text/css">

    <link rel="stylesheet" href="/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="/css/font-style.css">
    <link rel="stylesheet" href="/css/ng-grid.css" />
    <link rel="stylesheet" href="/css/web.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .input-group-addon {
            font-size: 15px;
            text-align: right;
            width: 210px;
        }
        .input-group-addon i {
            font-size: 20px;
        }

        .input-group {
            padding-bottom: 10px;
        }
        .author > small > p {
            padding: 0px;
        }

    </style>
</head>

<body class="module-body" ng-controller="UserImportCtrl" ng-cloak class="ng-cloak">
    <div class="wrapper">
    <header class="nav-down">
      <% include ../includes/header %>
    </header>
    <section ng-show="contentLoaded" class="banner-container container-section sectionNextToHeader">
        <div class="container">
            <div class="row">
              <!-- <div class="alert alert-danger" role="alert" ng-show="uploaderrormsg">{{uploaderrormsg}}</div> -->
                <!-- <div class="col-md-1"></div> -->
                <div id="mainContentColumn" class="col-md-12 intro-container right-column-ct" style="1px solid #ddd !important;">
                    <div class="col-md-12">
                      <div>
                        <button class="btn btn-primary pull-right" data-toggle="modal" data-target="#userExportModal" ng-click="getAllExportCourses()">Export</button>
                        <button class="btn btn-primary pull-right import-btn" data-toggle="modal" data-target="#userImportModal">Import</button>
                      </div>  
                      <div class="userimport">
                            <!--Import Modal -->
                          <div  class="modal fade" id="userImportModal" tabindex="-1" role="dialog" aria-labelledby="importModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                  <h4 class="modal-title" id="importModalLabel">{{uploadModel.title}}</h4>
                                </div>
                                <div class="modal-body row">
                                  <form class="form-horizontal" role="form">
                                    <div>
                                      <div class="form-group">
                                        <label class="col-md-5 control-label">Job Type :</label>
                                        <div class="col-md-7">
                                          <div class="form-control-static">
                                            <select class="form-control csv-type-select"  ng-options="uploadData.name for uploadData in uploadArray" ng-model="uploadModel" ng-change="updateUploadUI()">
                                             </select>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="form-group">
                                        <label class="col-md-5 control-label">Course :</label>
                                        <div class="col-md-7">
                                          <div class="form-control-static">
                                            <select class="form-control csv-type-select" ng-options="course.name for course in allExportCourses" ng-model="courseUploadModel">
                                              <option value="">Select a Course</option>
                                             </select>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="form-group ">
                                        <label for="file" class="col-md-5 control-label">File :</label>
                                        <div class="col-md-7">
                                          <div class="form-control-static">
                                            <input type="file" file-model="csvFile" ng-file-select="onSelectFile($files)">
                                         </div>
                                        </div>
                                      </div>
                                      <div class="form-group" ng-show="uploadModel.method == 'delete'">
                                        <label for="button" class="col-md-5 control-label">Delete Type :</label>
                                        <div class="col-md-7">
                                          <div class="form-control-static">
                                            <input style="margin-right: 10px;" type="radio" name="deleteoptions" value="1" ng-model="deleteSelection" ng-click="url = uploadModel.url" >Soft Delete <br/>
                                            <input style="margin-right: 10px;" type="radio" name="deleteoptions" value="2" ng-model="deleteSelection" ng-click="url = uploadModel.cleanupurl">Cleanup
                                          </div>
                                          <div style="margin-top:5px;" ng-show="deleteSelection=='2'"><b>Note:</b> Cleanup will remove the data permanently.</div>
                                      </div>
                                      </div>
                                    </div>
                                    <div class="col-md-12 user-import-warning">
                                         <span ng-show="errorinupload" class="alert alert-danger" role="alert">Error while uploading the file.</span> 
                                         <span ng-show="csvfilenotvalid" class="alert alert-warning" role="alert">Please Select the CSV file.</span>
                                         <span ng-show="selectCourse" class="alert alert-danger" role="alert">Please select a course.</span> 
                                    </div>
                                  </form>
                                </div>
                                <div class="modal-footer">
                                  <button type="submit" class="btn btn-primary" ng-show="csvFile" ng-click="url = uploadModel.url; uploadFile();" ng-disabled="uploadProcessing">Upload{{uploadProcessing ? 'ing...' : ''}}</button>
                                </div>
                              </div>
                            </div>
                          </div>
                      </div>
                      <div class="userexport">
                            <!--Export Modal -->
                          <div  class="modal fade" id="userExportModal" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                  <h4 class="modal-title" id="exportModalLabel">Export {{downloadModel.name}}</h4>
                                </div>
                                <div class="modal-body row">
                                  <div class="form-inline">
                                    <div class="col-md-1"></div>
                                      <div class="col-md-10 text-center">
                                        <label>Course :</label>
                                        <select class="form-control export-select"   ng-options="course.name for course in allExportCourses" ng-model="downloadModel" ng-change="courseDownloadPath();assessmentsDownloadPath();">
                                          <option value="">Select a Course</option>
                                         </select>
                                        <br/>
                                        <br/>
                                        <a href="{{courseDownloadURL}}" ng-show="downloadModel" class="btn btn-primary">Download Course Content</a>
                                        <a href="{{assessmentsDownloadURL}}" ng-show="downloadModel" class="btn btn-primary">Download Question Data</a>
                                      </div>  
                                    <div class="col-md-1"></div>
                                  </div>  
                                </div>
                              </div>
                            </div>
                          </div>
                      </div>
                      <div class="errordetails">
                         <div  class="modal fade" id="errorDetailsModal" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                  <h4 class="modal-title" id="errorDtlModalLabel">Warning or Error Details</h4>
                                </div>
                                <div class="modal-body row">
                                    <div class="row container-fluid">
                                        <div class="col-md-12">
                                          <div style="height:400px;overflow: scroll;margin-left:15px;">
                                            <div style="padding:5px;border-bottom:1px solid #999;" ng-repeat="error in errorDetails">{{$index+1}}. {{error}}</div>
                                          </div>
                                        </div>  
                                    </div> 

                                </div>
                              </div>
                            </div>
                          </div>
                      </div>  
                      <div class="table-responsive">
                        <div id="importTableGridId" class="gridStyle" ng-grid="gridOptions"></div>
                      </div>
                    </div>
                </div>
                <!-- <div class="col-md-1"></div> -->
            </div>
        </div>
    </section>
    </div>
</body>
<script src="/js/jquery.min.js"></script>
<script src="/js/angular.min.js"></script>
<script src="/js/angular-route.min.js"></script>
<script src="/js/controllers/importController.js"></script>
<script src="/js/controllers/loginController.js"></script>
<script src="/js/angular-file-upload.min.js"></script>
<script src="/js/bootstrap.min.js"></script>

<script src="/js/custom.js"></script>
<script src="/js/student-custom.js"></script>
<script src="/js/MetroJs.lt.min.js"></script>
<script src="/js/jquery-ui-1.10.3.custom.min.js"></script>
<script src="/js/jquery.rs.carousel.js"></script>
<script src="/js/custom.js"></script>
<script src="/js/angular-sanitize.min.js"></script>
<script src="/js/angular-file-upload.min.js"></script>
<script src="/js/ng-grid-min.js"></script>

<footer id="pageFooter" style="display:block;" class="content-loaded">
    <% include ../includes/footer %>
</footer>

</html>
